-- Migration: Add marketing_features_i18n column to subscription_plans
-- Stores locale-specific translations for plan marketing feature strings.
-- Structure: { "hi": ["...", "..."], "ml": ["...", "..."] }
-- English remains the source of truth in marketing_features (existing column).

ALTER TABLE subscription_plans
  ADD COLUMN IF NOT EXISTS marketing_features_i18n JSONB NOT NULL DEFAULT '{}';

COMMENT ON COLUMN subscription_plans.marketing_features_i18n IS
  'Locale-keyed translations of marketing_features. Keys are BCP-47 language codes (hi, ml, etc.). English source lives in marketing_features.';

-- ─── Free plan ───────────────────────────────────────────────────────────────
UPDATE subscription_plans
SET marketing_features_i18n = '{
  "hi": [
    "दैनिक बाइबल वचन",
    "8 अध्ययन टोकन/दिन",
    "सभी अध्ययन मोड (सीमित टोकन)",
    "निर्देशित सीखने के रास्ते",
    "3 वचन तक याद करें",
    "2 मेमोरी वर्स अभ्यास मोड",
    "अध्ययन मार्गदर्शिका फॉलो-अप — शामिल नहीं",
    "डिसाइपल AI — शामिल नहीं"
  ],
  "ml": [
    "ദൈനിക ബൈബിൾ വാക്യം",
    "ദിവസം 8 സ്റ്റഡി ടോക്കൺ",
    "എല്ലാ സ്റ്റഡി മോഡുകളും (പരിമിതമായ ടോക്കൺ)",
    "ഗൈഡഡ് ലേണിംഗ് പാതകൾ",
    "3 വരെ വാക്യങ്ങൾ മനഃപ്പാഠമാക്കാം",
    "2 മെമ്മറി വേഴ്സ് പ്രാക്ടീസ് മോഡുകൾ",
    "സ്റ്റഡി ഗൈഡ് ഫോളോ-അപ്പ് — ഉൾപ്പെടുന്നില്ല",
    "ഡിസൈപ്പിൾ AI — ഉൾപ്പെടുന്നില്ല"
  ]
}'
WHERE plan_code = 'free';

-- ─── Standard plan ───────────────────────────────────────────────────────────
UPDATE subscription_plans
SET marketing_features_i18n = '{
  "hi": [
    "दैनिक बाइबल वचन",
    "20 अध्ययन टोकन/दिन",
    "सभी अध्ययन मोड (सीमित टोकन)",
    "निर्देशित सीखने के रास्ते",
    "5 वचन तक याद करें",
    "सभी 8 मेमोरी वर्स अभ्यास मोड",
    "प्रति मार्गदर्शिका 5 फॉलो-अप",
    "डिसाइपल AI — 3 सत्र/महीना"
  ],
  "ml": [
    "ദൈനിക ബൈബിൾ വാക്യം",
    "ദിവസം 20 സ്റ്റഡി ടോക്കൺ",
    "എല്ലാ സ്റ്റഡി മോഡുകളും (പരിമിതമായ ടോക്കൺ)",
    "ഗൈഡഡ് ലേണിംഗ് പാതകൾ",
    "5 വരെ വാക്യങ്ങൾ മനഃപ്പാഠമാക്കാം",
    "എല്ലാ 8 മെമ്മറി വേഴ്സ് പ്രാക്ടീസ് മോഡുകളും",
    "പ്രതി ഗൈഡ് 5 ഫോളോ-അപ്പ്",
    "ഡിസൈപ്പിൾ AI — 3 സെഷൻ/മാസം"
  ]
}'
WHERE plan_code = 'standard';

-- ─── Plus plan ────────────────────────────────────────────────────────────────
UPDATE subscription_plans
SET marketing_features_i18n = '{
  "hi": [
    "दैनिक बाइबल वचन",
    "50 अध्ययन टोकन/दिन",
    "सभी अध्ययन मोड",
    "निर्देशित सीखने के रास्ते",
    "10 वचन तक याद करें",
    "सभी 8 मेमोरी वर्स अभ्यास मोड",
    "प्रति मार्गदर्शिका 10 फॉलो-अप",
    "डिसाइपल AI — 10 सत्र/महीना"
  ],
  "ml": [
    "ദൈനിക ബൈബിൾ വാക്യം",
    "ദിവസം 50 സ്റ്റഡി ടോക്കൺ",
    "എല്ലാ സ്റ്റഡി മോഡുകളും",
    "ഗൈഡഡ് ലേണിംഗ് പാതകൾ",
    "10 വരെ വാക്യങ്ങൾ മനഃപ്പാഠമാക്കാം",
    "എല്ലാ 8 മെമ്മറി വേഴ്സ് പ്രാക്ടീസ് മോഡുകളും",
    "പ്രതി ഗൈഡ് 10 ഫോളോ-അപ്പ്",
    "ഡിസൈപ്പിൾ AI — 10 സെഷൻ/മാസം"
  ]
}'
WHERE plan_code = 'plus';

-- ─── Premium plan ─────────────────────────────────────────────────────────────
UPDATE subscription_plans
SET marketing_features_i18n = '{
  "hi": [
    "दैनिक बाइबल वचन",
    "असीमित अध्ययन टोकन",
    "सभी अध्ययन मोड",
    "निर्देशित सीखने के रास्ते",
    "असीमित वचन याद करें",
    "सभी 8 मेमोरी वर्स अभ्यास मोड",
    "प्रति मार्गदर्शिका असीमित फॉलो-अप",
    "डिसाइपल AI — असीमित"
  ],
  "ml": [
    "ദൈനിക ബൈബിൾ വാക്യം",
    "അൺലിമിറ്റഡ് സ്റ്റഡി ടോക്കൺ",
    "എല്ലാ സ്റ്റഡി മോഡുകളും",
    "ഗൈഡഡ് ലേണിംഗ് പാതകൾ",
    "അൺലിമിറ്റഡ് വാക്യങ്ങൾ മനഃപ്പാഠമാക്കാം",
    "എല്ലാ 8 മെമ്മറി വേഴ്സ് പ്രാക്ടീസ് മോഡുകളും",
    "പ്രതി ഗൈഡ് അൺലിമിറ്റഡ് ഫോളോ-അപ്പ്",
    "ഡിസൈപ്പിൾ AI — അൺലിമിറ്റഡ്"
  ]
}'
WHERE plan_code = 'premium';
